create table Player(AARAmembership i, name s30, streetNum i, street s50, city s30, state s2, sponsorshipType i);
create table Company(name s30, streetNum i, street s50, city s30, state s2, netWorth f);
create table CompanySponsored(name s30, AARAmembership i);

reset io;
load Player("../data/MoreData/player.data");
print io;
select * from Player;


load Company("../data/MoreData/company.data");
select * from Company;

queryplans on;
reset io;
load CompanySponsored("../data/MoreData/companysponsored.data");
print io;

queryplans on;
reset io;
create index Player(AARAmembership);
print io;

queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, Player.name
from Player
where Player.AARAmembership < 10;
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, Player.name
from Player
where Player.AARAmembership = 10;
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, Player.name
from Player
where Player.AARAmembership = 10 and Player.name = "JT Goldman";
print io;

queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, Player.name
from Player
where Player.name = "JT Goldman" and Player.AARAmembership = 10;
print io;


/* FIX THIS: Using index join */
queryplans on;
reset buffer;
reset io;
select CompanySponsored.AARAmembership, Company.name, CompanySponsored.name
from   CompanySponsored, Company
where  CompanySponsored.name = Company.name;
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, CompanySponsored.AARAmembership, CompanySponsored.name
from   Player, CompanySponsored
where  Player.AARAmembership = CompanySponsored.AARAmembership;
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, CompanySponsored.AARAmembership, CompanySponsored.name
from   Player, CompanySponsored
where  Player.AARAmembership = 10 and Player.AARAmembership = CompanySponsored.AARAmembership;
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, CompanySponsored.AARAmembership, CompanySponsored.name
from   Player, CompanySponsored
where  Player.name = "JT Goldman" and Player.AARAmembership = CompanySponsored.AARAmembership;
print io;



create index Company(name);
create index CompanySponsored(name);
create index CompanySponsored(AARAmembership);
reset io;



queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, CompanySponsored.AARAmembership, Company.name, 
       CompanySponsored.name
from   Company, CompanySponsored, Player
where  Player.AARAmembership = CompanySponsored.AARAmembership and
       CompanySponsored.name = Company.name;
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, CompanySponsored.AARAmembership, Company.name, 
       CompanySponsored.name
from   Player, CompanySponsored, Company
where  Player.AARAmembership = CompanySponsored.AARAmembership and
       CompanySponsored.name = "Wilson" and
       CompanySponsored.name = Company.name;
print io;



queryplans on;
reset buffer;
reset io;
select Player.AARAmembership, CompanySponsored.AARAmembership, Company.name, 
       CompanySponsored.name
from   Player, CompanySponsored, Company
where  Player.AARAmembership = CompanySponsored.AARAmembership and
       CompanySponsored.name = Company.name;
print io;



queryplans on;
reset buffer;
reset io;
drop index CompanySponsored(name);
print io;


queryplans on;
reset buffer;
reset io;
select Player.AARAmembership
from   Player
where  Player.AARAmembership > 5 and
       Player.AARAmembership < 2;
print io;



queryplans on;
reset buffer;
reset io;
select CompanySponsored.AARAmembership
from CompanySponsored
where 
 CompanySponsored.name = "This string is just too long for any name to ever match it.";
print io;

queryplans on;
reset buffer;
reset io;
select CompanySponsored.AARAmembership
from CompanySponsored
where CompanySponsored.AARAmembership = 10 and 
      CompanySponsored.AARAmembership = 10 and 
      CompanySponsored.AARAmembership = 10 and 
      CompanySponsored.AARAmembership = 10 and 
      CompanySponsored.AARAmembership = 10 and 
      CompanySponsored.AARAmembership = 10 and 
      CompanySponsored.AARAmembership = 10;
print io;

queryplans on;
reset buffer;
reset io;
update Player set name = "Foo"
where AARAmembership = 10;
print io;
select * from Player where AARAmembership = 10;

queryplans on;
reset buffer;
reset io;
delete from Player;
print io;
select * from Player;